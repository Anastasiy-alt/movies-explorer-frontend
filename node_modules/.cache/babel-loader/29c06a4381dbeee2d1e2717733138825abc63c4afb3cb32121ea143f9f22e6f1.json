{"ast":null,"code":"import _slicedToArray from\"/Users/anastasiavolokitina/Documents/GitHub/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'../../index.css';import Header from'../Header/header';import Promo from'../Main/Promo/promo';import AboutProject from'../Main/AboutProject/aboutProject';import Techs from'../Main/Techs/techs';import AboutMe from'../Main/AboutMe/aboutMe';import Footer from'../Footer/footer';// import Preloader from '../Movies/Preloader/Preloader';\nimport*as auth from'../../utils/auth';import{useState,useEffect}from'react';import{Route,Switch,useHistory}from'react-router-dom';import{CurrentUserContext}from'../../context/CurrentUserContext';import api from'../../utils/Api';import Login from'../Login/Login';import Register from'../Register/Register';import SearchForm from'../Movies/SearchForm/SearchForm';import MoviesCardList from'../Movies/MoviesCardList/MoviesCardList';import More from'../Movies/More/More';import NotFound from'../NotFound/NotFound';import Profile from'../Profile/Profile';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loggedIn=_useState2[0],setLoggedIn=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),userEmail=_useState4[0],setUserEmail=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),currentUser=_useState6[0],setCurrentUser=_useState6[1];var tokenCheck=function tokenCheck(){var jwt=localStorage.getItem('jwt');if(jwt){return;}auth.checkToken(jwt).then(function(data){setUserEmail(data.email);setCurrentUser(data);setLoggedIn(true);history.push(\"/\");}).catch(function(err){return console.log(err);});};useEffect(function(){tokenCheck();},[]);var handleSignOut=function handleSignOut(){setLoggedIn(false);localStorage.removeItem('jwt');history.push(\"/signin\");};var handleUpdateUser=function handleUpdateUser(userData){api.setUserInfo(userData).then(function(data){setCurrentUser(data);}).catch(function(error){console.log(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \".concat(error));});};function handleLogin(email,password){return auth.authorize(email,password).then(function(data){if(data){setLoggedIn(true);localStorage.setItem('jwt',data.token);setUserEmail(email);history.push(\"/\");tokenCheck();}}).catch(function(err){console.log(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \".concat(err));});}// registration\nfunction handleRegister(name,email,password){return auth.register(name,email,password).then(function(user){setLoggedIn(true);setCurrentUser(user);// setIsSuccess(true);\n// setIsInfoTooltipPopupOpen(true);\nhistory.push(\"/signin\");}).catch(function(err){console.log(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \".concat(err));});}return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/\",children:[/*#__PURE__*/_jsx(Header,{loggedIn:loggedIn}),/*#__PURE__*/_jsx(Promo,{}),/*#__PURE__*/_jsx(AboutProject,{}),/*#__PURE__*/_jsx(Techs,{}),/*#__PURE__*/_jsx(AboutMe,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/saved-movies\",children:[/*#__PURE__*/_jsx(Header,{loggedIn:\"true\",movies:\"true\"}),/*#__PURE__*/_jsx(SearchForm,{}),/*#__PURE__*/_jsx(MoviesCardList,{}),/*#__PURE__*/_jsx(More,{}),/*#__PURE__*/_jsx(Footer,{movies:\"true\"})]}),/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/movies\",children:[/*#__PURE__*/_jsx(Header,{loggedIn:\"true\",movies:\"true\"}),/*#__PURE__*/_jsx(SearchForm,{}),/*#__PURE__*/_jsx(MoviesCardList,{}),/*#__PURE__*/_jsx(More,{}),/*#__PURE__*/_jsx(Footer,{movies:\"true\"})]}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/signup\",children:/*#__PURE__*/_jsx(Register,{onRegister:handleRegister})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/signin\",children:/*#__PURE__*/_jsx(Login,{onLogin:handleLogin})}),/*#__PURE__*/_jsxs(Route,{exact:true,path:\"/profile\",children:[/*#__PURE__*/_jsx(Header,{loggedIn:\"true\",movies:\"true\"}),/*#__PURE__*/_jsx(Profile,{handleUpdateUser:handleUpdateUser,onSignOut:handleSignOut})]}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"*\",children:/*#__PURE__*/_jsx(NotFound,{})})]})})});}export default App;","map":{"version":3,"names":["Header","Promo","AboutProject","Techs","AboutMe","Footer","auth","useState","useEffect","Route","Switch","useHistory","CurrentUserContext","api","Login","Register","SearchForm","MoviesCardList","More","NotFound","Profile","App","history","loggedIn","setLoggedIn","userEmail","setUserEmail","currentUser","setCurrentUser","tokenCheck","jwt","localStorage","getItem","checkToken","then","data","email","push","catch","err","console","log","handleSignOut","removeItem","handleUpdateUser","userData","setUserInfo","error","handleLogin","password","authorize","setItem","token","handleRegister","name","register","user"],"sources":["/Users/anastasiavolokitina/Documents/GitHub/movies-explorer-frontend/src/components/App/App.jsx"],"sourcesContent":["import '../../index.css';\nimport Header from '../Header/header';\nimport Promo from '../Main/Promo/promo';\nimport AboutProject from '../Main/AboutProject/aboutProject';\nimport Techs from '../Main/Techs/techs';\nimport AboutMe from '../Main/AboutMe/aboutMe';\nimport Footer from '../Footer/footer';\n// import Preloader from '../Movies/Preloader/Preloader';\nimport * as auth from '../../utils/auth';\nimport { useState, useEffect } from 'react';\nimport { Route, Switch, useHistory } from 'react-router-dom';\nimport { CurrentUserContext } from '../../context/CurrentUserContext';\nimport api from '../../utils/Api';\nimport Login from '../Login/Login';\nimport Register from '../Register/Register';\nimport SearchForm from '../Movies/SearchForm/SearchForm';\nimport MoviesCardList from '../Movies/MoviesCardList/MoviesCardList';\nimport More from '../Movies/More/More';\nimport NotFound from '../NotFound/NotFound';\nimport Profile from '../Profile/Profile';\n\nfunction App() {\n  const history = useHistory();\n\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [userEmail, setUserEmail] = useState(\"\");\n  const [currentUser, setCurrentUser] = useState({});\n\n  const tokenCheck = () => {\n    const jwt = localStorage.getItem('jwt');\n    if (jwt) {\n      return;\n    }\n    auth\n      .checkToken(jwt)\n      .then((data) => {\n        setUserEmail(data.email);\n        setCurrentUser(data);\n        setLoggedIn(true);\n        history.push(\"/\")\n      })\n      .catch((err) => console.log(err));\n  }\n\n  useEffect(() => {\n    tokenCheck()\n  }, []);\n\n  const handleSignOut = () => {\n    setLoggedIn(false);\n    localStorage.removeItem('jwt');\n    history.push(\"/signin\");\n  }\n\n  const handleUpdateUser = (userData) => {\n    api.setUserInfo(userData)\n      .then((data) => {\n        setCurrentUser(data);\n      })\n      .catch((error) => {\n        console.log(`Ошибка: ${error}`);\n      })\n  };\n\n  function handleLogin(email, password) {\n    return auth\n      .authorize(email, password)\n      .then((data) => {\n        if (data) {\n          setLoggedIn(true)\n          localStorage.setItem('jwt', data.token);\n          setUserEmail(email);\n          history.push(\"/\");\n          tokenCheck();\n        }\n      })\n      .catch((err) => {\n        console.log(`Ошибка: ${err}`);\n      })\n  }\n\n  // registration\n  function handleRegister(name, email, password) {\n    return auth\n      .register(name, email, password)\n      .then((user) => {\n        setLoggedIn(true)\n        setCurrentUser(user);\n        // setIsSuccess(true);\n        // setIsInfoTooltipPopupOpen(true);\n        history.push(\"/signin\");\n      })\n      .catch((err) => {\n        console.log(`Ошибка: ${err}`);\n      })\n  }\n\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"page\">\n\n        <Switch>\n          <Route exact path='/'>\n            <Header\n              loggedIn={loggedIn} />\n            <Promo />\n            <AboutProject />\n            <Techs />\n            <AboutMe />\n            <Footer />\n          </Route>\n\n          <Route exact path='/saved-movies'>\n          <Header\n              loggedIn='true'\n              movies='true' />\n            <SearchForm />\n            <MoviesCardList />\n            <More />\n            <Footer movies='true' />\n          </Route>\n\n          <Route exact path='/movies'>\n            <Header\n              loggedIn='true'\n              movies='true' />\n            <SearchForm />\n            <MoviesCardList />\n            <More />\n            <Footer movies='true' />\n          </Route>\n\n          <Route exact path='/signup'>\n            <Register onRegister={handleRegister} />\n          </Route>\n\n          <Route exact path='/signin'>\n            <Login onLogin={handleLogin} />\n          </Route>\n\n          <Route exact path='/profile'>\n            <Header\n            loggedIn='true'\n            movies='true' />\n            <Profile\n            handleUpdateUser={handleUpdateUser}\n            onSignOut={handleSignOut} />\n          </Route>\n\n          <Route exact path='*'>\n            <NotFound />\n          </Route>\n\n        </Switch>\n        {/* <Preloader /> */}\n\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}